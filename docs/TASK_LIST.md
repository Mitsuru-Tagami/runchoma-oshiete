# るんちょま対話型学習機能 実装タスクリスト

## 概要
るんちょまが答えを間違えた際の学習フローを、現在の自由入力形式から、過去の質問を再利用する対話形式へと変更する。

---

### ステータス：進行中

### タスク一覧

- [x] **UIの変更 (`index.html`, `style.css`, `ui.js`)**
    - [x] 学習フェーズ専用のUIをデザイン・実装する。
    - [x] 現在の質問ボタン（はい/いいえ/不明）を、学習フェーズで再利用できるように調整する。
    - [x] 新しいUI要素（例：「この質問は当てはまりますか？」というメッセージ表示エリア）を追加する。

- [x] **ゲームフローの変更 (`gameCore.js`)**
    - [x] `promptForAnswer`関数を修正し、新しい学習フローを開始するように変更する。
    - [x] `handleSubmitAnswer`関数を、新しい対話形式のロジックに合わせて全面的に書き直す。
    - [x] 学習フェーズ中に、過去の質問を一つずつユーザーに問いかける処理を実装する。
    - [x] ユーザーの回答（はい/いいえ/不明）に応じて、新しいアイテムの特性情報を一時的に構築する処理を実装する。
    - [x] 全ての質問が終わった後、完成した新しいアイテムデータを`dataManager.js`に渡す処理を実装する。
    - [x] どの質問をユーザーにしたかを、ゲームセッションを通じて正確に追跡・管理する仕組みを強化する。

- [x] **データ管理の確認 (`dataManager.js`)**
    - [x] `addNewItem`関数が、新しく構築されたアイテムデータを正しく受け取り、既存のデータとマージして保存できることを確認する。

- [x] **総合テスト・自動化**
    - [x] 新しい対話型学習フローが、意図通りに動作することを全体を通してテストする。
    - [x] 学習させた新しいアイテムが、次回のプレイ時に正しく特定されることを確認する。
    - [x] テストの自動化（ユニットテスト・E2Eテスト等）の導入・整備。
    - [memo] DB連携前に、既存の学習フローやデータ管理のテスト・自動化を優先すること。これにより、DB連携時の不具合切り分けや回帰テストが容易になる。
    - [memo] テスト自動化が整っていれば、DB連携後も安心して機能追加・修正ができる。

- [ ] **DB実装（今後予定）**
    - [ ] Google Cloud Platformでサービスアカウントを作成する。
    - [ ] サービスアカウントを利用してGoogleスプレッドシートを新規作成し、簡易DBとして利用する。
    - [ ] Google Sheets API連携部分の設計・実装。
    - [ ] DB連携部分のテスト・運用フローの整備。
    - [memo] Google Sheets API連携には、Google Cloud PlatformでのAPI有効化・認証情報取得・`googleapis`ライブラリ導入などが必要。
    - [memo] 個人・小規模用途ならGoogleスプレッドシートの無料枠（1シート1000万セル、API呼び出し1日10万回程度）で十分運用可能。
    - [memo] 保存したい情報（data.jsの内容やユーザー入力）は、API経由でシートに書き込む関数を`dataManager.js`等に追加し、保存タイミングを設計する。